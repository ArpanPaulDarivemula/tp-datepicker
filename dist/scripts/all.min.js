(function(){window.translations||(window.translations={}),window.translations.datepicker={start_from_sunday:0,months:["","Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],short_months:["","Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],days:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],legend:{startDate:"Дата заезда",endDate:"Дата выезда"}}}).call(this),function(){this.TpDatepickerMonthRenderer=function(){function t(t,e,r,i){var s;this.callback=t,this.daysNames=e,this.sundayFirst=r,i&&(this.marks=i),s=this.marks,this.marksPrev=s[0],this.marksCurrent=s[1],this.marksNext=s[2],this.isTouchDevice||(this.isTouchDevice=window.isTouchDevice)}return t.prototype.prefix="tp-datepicker-",t.prototype.marks=["prev","current-date","next"],t.prototype.isTouchDevice=null,t.prototype.render=function(t,e,r,i){return this._buildTable(this._monthDaysArray(t,e),r,i)},t.prototype._firstDay=function(t,e){return new Date(t,e-1,1).getDay()},t.prototype._monthLength=function(t,e){return 32-new Date(t,e-1,32,10).getDate()},t.prototype._monthDaysArray=function(t,e){var r,i,s,n,a,o,p,h,d;n=d=t,r=[],i=!0,1===e?(d--,a=12,s=e+1):12===e?(n++,s=1,a=e-1):(s=e+1,a=e-1),p=this._monthLength(d,a),h=p-this._firstDay(t,e)+1-this.sundayFirst,o=p+1,h===o&&(h-=6,i=!1);for(var c=h,l=o;l>c;r.push([d,a,c++,this.marksPrev]));for(var c=1,l=this._monthLength(t,e)+1;l>c;r.push([t,e,c++,this.marksCurrent]));for(var c=1;14>c;r.push([n,s,c++,this.marksNext]));return i&&r.shift(),r},t.prototype._callbackProxy=function(t){var e;return e=t.target,"DIV"===e.tagName&&(e=e.parentNode),e.classList.contains("tp-datepicker-current")&&e.hasAttribute("id")&&this.callback(t.type,e)},t.prototype._buildTable=function(t,e,r){var i,s,n,a,o,p,h,d,c,l,u,f,y;for(f=document.createElement("table"),f.classList.add(this.prefix+"table"),f.classList.add(this.prefix+"table--"+(this.sundayFirst?"sunday-first":"normal-weekdays")),i=function(t){return function(e){return t._callbackProxy(e)}}(this),f.addEventListener("click",i),f.addEventListener("mouseout",i),f.addEventListener("mouseover",i),window.isTouchDevice&&(f.addEventListener("touchstart",i),f.addEventListener("touchend",i),f.addEventListener("touchmove",i)),y=f.appendChild(document.createElement("tr")),h=l=0;6>=l;h=++l)p=y.appendChild(document.createElement("td")),p.classList.add(this.prefix+"day_name"),p.textContent=this.daysNames[h];for(o={},h=u=0;42>u;h=++u)s=t[h],h%7===0&&(p=f.appendChild(document.createElement("tr"))),n=s[0]+"-"+s[1]+"-"+s[2],d=""+this.prefix+n+"-"+s[3],a=o[d]=p.appendChild(document.createElement("td")),c=a.appendChild(document.createElement("div")),a.setAttribute("id",d),a.setAttribute("data-date",n),c.textContent=s[2],a.className=""+this.prefix+s[3],a.className+=e&&r>s[2]?" tp-datepicker-prev-date":" tp-datepicker-current";return this.days=o,f},t}()}.call(this),function(){this.TpDatepickerPopupRenderer=function(){function t(t,e){var r,i,s,n,a;this.datepicker=t,r=this.datepicker.t.days,a=this.datepicker.t.start_from_sunday,a&&r.unshift(r.pop()),this.monthRenderer=new TpDatepickerMonthRenderer(e,r,a),this.node=document.createElement("div"),this.nodeClassList=this.node.classList,this.nodeClassList.add("tp-datepicker"),this.nodeClassList.add("tp-datepicker-"+this.datepicker.type),i=document.createElement("div"),i.className="tp-datepicker-header",n=document.createElement("span"),n.className="tp-datepicker-prev-month-control",n.setAttribute("role","tp-datepicker-prev"),i.appendChild(n),this.MonthNode=document.createElement("span"),this.MonthNode.setAttribute("role","tp-datepicker-month"),i.appendChild(this.MonthNode),s=document.createElement("span"),s.className="tp-datepicker-next-month-control",s.setAttribute("role","tp-datepicker-next"),i.appendChild(s),this.node.appendChild(i),this.datepickerContainerNode=document.createElement("div"),this.datepickerContainerNode.className="tp-datepicker-container",this.datepickerContainerNode.setAttribute("role","tp-datepicker-table-wrapper"),this.datepickerContainerNode.appendChild(document.createElement("span")),this.node.appendChild(this.datepickerContainerNode),this.datepicker.legend&&(this.legendNode=document.createElement("span"),this.legendNode.className="tp-datepicker-legend",this.legendNode.setAttribute("role","tp-datepicker-legend"),this.node.appendChild(this.legendNode)),this.datepicker.datepickerWrapper.appendChild(this.node),this.node}return t.prototype.node=!1,t.prototype.monthRenderer=null,t.prototype.render=function(){var t,e,r;return r=this.datepicker.year,t=this.datepicker.month,e=this.monthRenderer.render(r,t,this.datepicker.isCirrentMonth,this.datepicker.currentDay),this.nodeClassList.toggle("tp-datepicker--current_month",this.isCirrentMonth),this.updateMonth(this.datepicker.t.months[t]+" "+r),this.datepickerContainerNode.replaceChild(e,this.datepickerContainerNode.childNodes[0])},t.prototype.updateMonth=function(t){return this.MonthNode.textContent=t},t}()}.call(this),function(){this.SwipeDetector=function(){function t(t,e,r){this.wrapper=null!=t?t:document.body,this.callbacks=null!=e?e:{},this.sensivity=null!=r?r:10,this.wrapper.addEventListener("touchstart",function(t){return function(e){return t.handleTouchStart(e)}}(this),!1),this.wrapper.addEventListener("touchend",function(t){return function(e){return t.handleTouchEnd(e)}}(this),!1),this.wrapper.addEventListener("touchmove",function(t){return function(e){return t.handleTouchMove(e)}}(this),!1)}return t.prototype.xDown=null,t.prototype.yDown=null,t.prototype.wrapper=null,t.prototype.callbacks={},t.prototype.sensivity=50,t.prototype.xDiff=0,t.prototype.yDiff=0,t.prototype.blockScroll=!1,t.prototype.handleTouchStart=function(t){return this.blockScroll=!0,this.xDown=t.touches[0].clientX,this.yDown=t.touches[0].clientY},t.prototype.handleTouchEnd=function(t){return this.blockScroll=!1,Math.abs(this.xDiff)>Math.abs(this.yDiff)?Math.abs(Math.abs(this.xDiff)-Math.abs(this.yDiff))>this.sensivity&&(this.xDiff>0?this.callbacks.left&&this.callbacks.left():this.callbacks.right&&this.callbacks.right()):Math.abs(Math.abs(this.yDiff)-Math.abs(this.xDiff))>this.sensivity&&(this.yDiff>0?this.callbacks.up&&this.callbacks.up():this.callbacks.down&&this.callbacks.down()),this.xDown=null,this.yDown=null,this.xDiff=0,this.yDiff=0},t.prototype.handleTouchMove=function(t){var e,r;return this.blockScroll&&t.preventDefault(),this.xDown&&this.yDown?(e=t.touches[0].clientX,r=t.touches[0].clientY,this.xDiff+=this.xDown-e,this.yDiff+=this.yDown-r,this.xDown=e,this.yDown=r):void 0},t}()}.call(this),function(){window.positionManager={positionAround:function(t,e,r){var i,s,n,a,o,p;return null==r&&(r=!1),e.style.position="absolute",i=document.body.getBoundingClientRect(),p=t.getBoundingClientRect(),o=this._getOffset(t),a=t.offsetHeight,s=document.documentElement.clientHeight-p.bottom,n=r||s>e.clientHeight,n||(n=s>p.top),n?(e.style.top=o.top+a+"px",e.style.left=o.left+"px"):(e.style.top=o.top-e.clientHeight+"px",e.style.left=o.left+"px")},_getOffset:function(t){var e,r;for(e=r=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetLeft-t.scrollLeft,r+=t.offsetTop-t.scrollTop,t=t.offsetParent;return{top:r,left:e}}}}.call(this),function(){this.TpDatepicker=function(){function t(t){var e,r,i,s,n;for(null==t&&(t={}),this.datepickerWrapper=t.wrapper||document.body,this.roles=t.role&&[t.role]||t.roles||["tp-datepicker"],this.role=this.roles[0],s=this.roles,e=0,r=s.length;r>e;e++)n=s[e],i=this.nodes[n]=this.datepickerWrapper.querySelector('[role="'+n+'"]'),i.classList.add("tp-datepicker-trigger"),this[n]=this._parseDate(i.getAttribute("data-date")),this.isTouchDevice?i.addEventListener("touchstart",this._listenerFor(n)):i.addEventListener("click",this._listenerFor(n)),i.addEventListener("focus",function(t){return t.preventDefault(),t.target.blur()});this._initPopup()}return t.prototype.roles=[],t.prototype.role=null,t.prototype.wrapper=!1,t.prototype.popupRenderer=!1,t.prototype.today=new Date,t.prototype.isCirrentMonth=!1,t.prototype.t=window.translations.datepicker,t.prototype.isTouchDevice=window.isTouchDevice,t.prototype.nodes=[],t.prototype.settedRoles=!1,t.prototype.legend=!1,t.prototype.type="simple",t.prototype.onDateSelect=function(t,e){return console.log(e+" selected date "+t)},t.prototype._initPopup=function(){var t;return this.currentMonth=this.today.getMonth()+1,this.currentYear=this.today.getFullYear(),this.currentDay=this.today.getDate(),t=function(t){return function(e,r){return t._callback_proxy(e,r)}}(this),this.popupRenderer=new TpDatepickerPopupRenderer(this,t),window.SwipeDetector&&new SwipeDetector(this.popupRenderer.node,{left:function(t){return function(){return t.nextMonth()}}(this),right:function(t){return function(){return t.prevMonth()}}(this),down:function(t){return function(){return t._setScale(0)}}(this),up:function(t){return function(){return t._setScale(0)}}(this)}),this.popupRenderer.node.querySelector('[role="tp-datepicker-prev"]').addEventListener("click",function(t){return function(){return t.prevMonth()}}(this)),this.popupRenderer.node.querySelector('[role="tp-datepicker-next"]').addEventListener("click",function(t){return function(){return t.nextMonth()}}(this)),document.addEventListener("click",function(t){return function(e){var r;if(r=e.target){if("BODY"!==r.tagName&&"HTML"!==r.tagName){if(t.roles.indexOf(r.getAttribute("role"))>-1)return void(window.sendMetric&&window.sendMetric("datepickerinputs_touch"));for(;(r=r.parentNode)&&"BODY"!==r.tagName;)if(!r.parentNode||r.classList.contains("tp-datepicker")||t.roles.indexOf(r.getAttribute("role"))>=0)return}return t.nodes[t.role].classList.remove("tp-datepicker-trigger--active"),t._setScale(0)}}}(this))},t.prototype.prevMonth=function(){return this.isCirrentMonth?void 0:(1===this.month?(this.year--,this.month=12):this.month--,this._renderDatepicker())},t.prototype.nextMonth=function(){return 12===this.month?(this.year++,this.month=1):this.month++,this._renderDatepicker()},t.prototype.show=function(t,e){var r,i,s;this.role=t,this.callback=e,this.date=this._parseDate(this[this.role])||this.today,this.month=this.date.getMonth()+1,this.year=this.date.getFullYear(),this._renderDatepicker(),i=this.nodes;for(s in i)r=i[s],r.classList.toggle("tp-datepicker-trigger--active",s===this.role);return window.positionManager?window.positionManager.positionAround(this.nodes[this.role],this.popupRenderer.node):void 0},t.prototype._callback_proxy=function(t,e){switch(t){case"click":return this.callback(e.getAttribute("data-date")),!0;default:return!1}},t.prototype._listenerFor=function(t){return function(e){return function(){return e.show(t,function(r){return e._showCallback(r,t)})}}(this)},t.prototype._showCallback=function(t,e){return t&&(this[e]=t),this._setupDate(e,this[e]),this.settedRoles?void 0:(this.nodes[this.role].classList.remove("tp-datepicker-trigger--active"),this._setScale(0),this.onDateSelect(t,e))},t.prototype._setupDate=function(t,e){return this.nodes[t].setAttribute("data-date",e),this.nodes[t].setAttribute("value",this._formatDate(e))},t.prototype._renderDatepicker=function(){return this.isCirrentMonth=this.currentYear===this.year&&this.currentMonth===this.month,this.popupRenderer.render(this),this._setScale(1)},t.prototype._parseDate=function(t){var e;if(t)return e=t.split("-"),new Date(e[0],parseInt(e[1],10)-1,e[2])},t.prototype._stringifyDate=function(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},t.prototype._formatDate=function(t){var e;if(t)return e=t.split("-"),e[2]+" "+this.t.short_months[parseInt(e[1],10)]+" "+e[0]},t.prototype._setScale=function(t,e){return null==e&&(e=this.popupRenderer.node),e.style.webkitTransform=e.style.transform="scale("+t+")"},t}()}.call(this),function(){var t=function(t,r){function i(){this.constructor=t}for(var s in r)e.call(r,s)&&(t[s]=r[s]);return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t},e={}.hasOwnProperty;this.TpDatepickerRange=function(e){function r(t){var e;null==t&&(t={}),t.role=null,t.roles||(t.roles=["startDate","endDate"]),t.legend&&(this.legend=t.legend),r.__super__.constructor.call(this,t),e=this.roles,this.startDateRole=e[0],this.endDateRole=e[1],this.settedRoles[this.startDateRole]=this.settedRoles[this.endDateRole]=!1}return t(r,e),r.prototype.isEndDate=!1,r.prototype.settedRoles={},r.prototype.prevRole=!1,r.prototype.readyToDraw=!0,r.prototype.legend=!1,r.prototype.type="range",r.prototype.onRangeSelect=function(t,e,r){return console.log(r+" selected range from "+t+" to "+e)},r.prototype.show=function(t,e){return this.role=t,this.callback=e,this.isEndDate=this.role===this.endDateRole,r.__super__.show.call(this,this.role,this.callback),this.prevRole=this.role},r.prototype._callback_proxy=function(t,e){if(r.__super__._callback_proxy.call(this,t,e))return!0;switch(t){case"mouseout":return this.readyToDraw=!0,!0;case"mouseover":if(!this.readyToDraw)return;return this.isEndDate?this._drawSausage(this.startDate,e.getAttribute("data-date")):this._drawSausage(e.getAttribute("data-date"),this.endDate),this.readyToDraw=!1,!0;default:return!1}},r.prototype._currentDateType=function(){return this.isEndDate?"endDate":"startDate"},r.prototype._showCallback=function(t,e){var i;return r.__super__._showCallback.call(this,t,e),t&&(this[this._currentDateType()]=t),this.settedRoles[e]=!0,this._checkDates(e),i=this._oppositeRole(e),this.settedRoles[i]?(this.nodes[this.role].classList.remove("tp-datepicker-trigger--active"),this._setScale(0)):(this._setupDate(i,this[i]),this._listenerFor(i)()),this.onRangeSelect(this.startDateObj,this.endDateObj,e)},r.prototype._oppositeRole=function(){return this.isEndDate?this.startDateRole:this.endDateRole},r.prototype._checkDates=function(t){var e;return this.startDateObj=this._parseDate(this.startDate)||this.endDateObj&&this._changeDate(this.endDateObj,-1)||this.today,this.endDateObj=this._parseDate(this.endDate)||this.startDateObj&&this._changeDate(this.startDateObj,1),e=this._oppositeRole(t),(this.startDateObj>=this.endDateObj||!this.settedRoles[e]||this.endDateObj===this.today)&&(this.settedRoles[e]=!1,this.isEndDate?(this.endDateObj===this.today&&(this.endDateObj=this._changeDate(this.today,1)),this.startDateObj=this._changeDate(this.endDateObj,-1)):this.endDateObj=this._changeDate(this.startDateObj,1)),this.startDate=this[this.startDateRole]=this._stringifyDate(this.startDateObj),this.endDate=this[this.endDateRole]=this._stringifyDate(this.endDateObj)},r.prototype._renderDatepicker=function(){return r.__super__._renderDatepicker.call(this),this._drawSausage(this.startDate,this.endDate),this.legend&&this.prevRole!==this.role?this._updateLegend(this.t.legend[this._currentDateType()]):void 0},r.prototype._updateLegend=function(t){var e;return e=this.popupRenderer.legendNode,e.textContent=t,e.classList.toggle("tp-datepicker-legend--start-date",!this.isEndDate),e.classList.toggle("tp-datepicker-legend--end-date",this.isEndDate),this._setScale(1.2,e),setTimeout(function(t){return function(){return t._setScale(1,e)}}(this),200)},r.prototype._drawSausage=function(t,e){var r,i,s,n,a,o,p,h,d,c,l,u;if(t||e){t||(t=e),e||(e=t),i=t.split("-"),r=e.split("-"),u=parseInt(i[1],10)<this.month&&parseInt(r[1],10)>=this.month,a=parseInt(r[1],10)<this.month&&parseInt(i[1],10)>=this.month,t="tp-datepicker-"+t+"-current-date",e="tp-datepicker-"+e+"-current-date",l=t===e,d=this.popupRenderer.monthRenderer.days,c=[];for(n in d)h=d[n],s=h.classList,s.contains("tp-datepicker-current")?(p=t===n,o=e===n,!p||(l||a)&&this.isEndDate?o&&(u||this.isEndDate)?(s.add("tp-datepicker-end-sausage"),s.remove("tp-datepicker-range"),s.remove("tp-datepicker-start-sausage"),s.remove("tp-datepicker-end-sausage--invisible"),s.remove("tp-datepicker-start-sausage--invisible"),u&&s.add("tp-datepicker-range"),u=l,c.push(a=!0)):u&&!a?(s.add("tp-datepicker-range"),s.remove("tp-datepicker-start-sausage"),c.push(s.remove("tp-datepicker-end-sausage"))):(o?(a=!0,s.add("tp-datepicker-end-sausage--invisible"),s.remove("tp-datepicker-start-sausage--invisible")):p?(s.add("tp-datepicker-start-sausage--invisible"),s.remove("tp-datepicker-end-sausage--invisible")):(s.remove("tp-datepicker-start-sausage--invisible"),s.remove("tp-datepicker-end-sausage--invisible")),s.remove("tp-datepicker-range"),s.remove("tp-datepicker-start-sausage"),c.push(s.remove("tp-datepicker-end-sausage"))):(s.add("tp-datepicker-start-sausage"),s.remove("tp-datepicker-range"),s.remove("tp-datepicker-end-sausage"),s.remove("tp-datepicker-end-sausage--invisible"),s.remove("tp-datepicker-start-sausage--invisible"),u=!l,c.push(u&&!a?s.add("tp-datepicker-range"):void 0))):c.push(void 0);return c}},r.prototype._changeDate=function(t,e){return null==e&&(e=1),new Date(new Date(t).setDate(t.getDate()+e))},r}(TpDatepicker)}.call(this);